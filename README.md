# Feby

Playground for experiments with NPM packages development process using [NPM Registry](https://docs.npmjs.com/misc/registry).

## [Add user / Login](https://docs.npmjs.com/cli/adduser)
```
npm login
```
then provide username, password, and email. NPM will store info, and `npm whoami` should work - return username. [Details](https://docs.npmjs.com/cli/whoami).

## [NPM Token](https://docs.npmjs.com/getting-started/working_with_tokens)

When package is ready to publish, NPM user should be logged in, and NPM should have tokens generated.
 
Look to `~/.npmrc` file or run command `npm token list`:

```
 npm token list
┌────────┬─────────┬────────────┬──────────┬────────────────┐
│ id     │ token   │ created    │ readonly │ CIDR whitelist │
├────────┼─────────┼────────────┼──────────┼────────────────┤
│ 8a0b90 │ 3bbc39… │ 2018-07-04 │ no       │                │
├────────┼─────────┼────────────┼──────────┼────────────────┤
│ fd81e6 │ 283fec… │ 2018-07-04 │ no       │                │
├────────┼─────────┼────────────┼──────────┼────────────────┤
│ 57700d │ e0bf40… │ 2018-03-15 │ no       │                │
└────────┴─────────┴────────────┴──────────┴────────────────┘

```

Note: 
- `3bbc39...` is token generated by NodeJS `v8.1.12` / npm `v5.6.0` at my work machine.
- `283fec...` is token generated by NodeJS `v10.4.0` / npm `v.61.0` on my home machine.
- `e0bf40...` no idea, but some old token, generated time ago, in March 2018, when I played/tried with `feby` republish.

There is manual approach to create TOKEN:
`npm token create`:
npm password: ***
 
```
 ┌────────────────┬──────────────────────────────────────┐
 │ token          │ 7f899...                             │
 ├────────────────┼──────────────────────────────────────┤
 │ cidr_whitelist │                                      │
 ├────────────────┼──────────────────────────────────────┤
 │ readonly       │ false                                │
 ├────────────────┼──────────────────────────────────────┤
 │ created        │ 2018-07-04T16:01:29.041Z             │
 └────────────────┴──────────────────────────────────────┘
```

And `npm token list` now will show more tokens. And `npm token delete 57700d` will delete (invalidate) token from list.

### CI & Token Related info:
- https://docs.npmjs.com/private-modules/ci-server-config
- https://www.npmjs.com/package/npm-profile
- https://www.npmjs.com/package/npm-cli-login
- https://github.com/npm/npm-registry-client
- https://issues.jenkins-ci.org/browse/JENKINS-45854
- https://github.com/npm/npm/issues/12111

## [Publish](https://docs.npmjs.com/cli/publish)

Doesn't work:
```
npm publish feby
```

Works:
```
npm publish
npm publish --access public
```

## Unpublish

```
npm unpublish feby@1.0.7
npm unpublish feby@1.0.8
```

Note: If only one valid version used, that version can b unpublished as above command. 
Need to publish new version, and then unpublish previous, but with such way:

## Remove tags

```
git tag -d 1.0.7 && git push origin :refs/tags/1.0.7
git tag -d 1.0.8 && git push origin :refs/tags/1.0.8
```

## [Version](https://docs.npmjs.com/cli/version)
```
npm version patch
```
will increase `version` field value, and commit file. Eg. `1.0.15` will be changed to `1.0.16`. `minor`, `major` are also available.

Also git tag will be created. So next `git push` will use it.
And when `npm publish` executed, then new version/release will be published to NPM registry.